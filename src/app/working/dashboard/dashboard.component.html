<div class="faculty-tracker">
  <div class="back-button-container">
    <button class="back-button" (click)="goBack()">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 12H5"></path>
        <path d="M12 19l-7-7 7-7"></path>
      </svg>
      Back
    </button>
  </div>
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <div class="graduation-cap-icon">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3L1 9L12 15L21 9V16H23V9L12 3Z" fill="white"/>
            <path d="M5 13.18V17.18C5 17.97 5.63 18.74 6.4 19.09C8.61 20.15 10.26 20.73 12 20.73C13.74 20.73 15.39 20.15 17.6 19.09C18.37 18.74 19 17.97 19 17.18V13.18L12 17L5 13.18Z" fill="white"/>
          </svg>
        </div>
        <div class="header-text">
          <h1>Welcome {{userName}}</h1>
          <p>Track your academic activities and monitor workload efficiently</p>
        </div>
      </div>
      <div class="header-right">
        <div class="user-profile">
          <div class="user-avatar" *ngIf="userProfileImage" [style.backgroundImage]="'url(' + userProfileImage + ')'">
          </div>
          <div class="user-avatar" *ngIf="!userProfileImage">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="7" r="4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <span class="user-name">Welcome, {{ userName }}</span>
          <button class="logout-btn" (click)="logout()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16 17l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Logout
          </button>
        </div>
        <!-- <div class="database-icon">
          <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="12" cy="5" rx="9" ry="3" stroke="#2563eb" stroke-width="2" fill="#3b82f6"/>
            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" stroke="#2563eb" stroke-width="2"/>
            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" stroke="#2563eb" stroke-width="2"/>
          </svg>
        </div> -->
      </div>
    </div>
  </header>

  <nav class="navigation">
    <div class="nav-item" routerLink="/dashboard" routerLinkActive="active" (click)="navigateToTab('dashboard')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
      </svg>
      Dashboard
    </div>
    <div class="nav-item" routerLink="/log-task" routerLinkActive="active" (click)="navigateToTab('log-task')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" fill="none"/>
        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" fill="none"/>
        <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
        <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
        <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2"/>
      </svg>
      Log Task
    </div>
    <div class="nav-item" routerLink="/analytics" routerLinkActive="active" (click)="navigateToTab('analytics')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12" stroke="currentColor" stroke-width="2" fill="none"/>
      </svg>
      Analytics
    </div>
  </nav>

  <div class="stats-container">
    <div class="stat-card">
      <h3>Total Tasks</h3>
      <div class="stat-value">{{ totalTasks }}</div>
    </div>
    <div class="stat-card">
      <h3>Total Hours</h3>
      <div class="stat-value">{{ totalHours.toFixed(1) }}h</div>
    </div>
    <div class="stat-card">
      <h3>Active Subjects</h3>
      <div class="stat-value">{{ activeSubjects }}</div>
    </div>
    <div class="stat-card">
      <h3>Generate Report</h3>
      <button class="pdf-btn" (click)="generateWeeklyReport()" [disabled]="isGeneratingPDF">
        <svg *ngIf="!isGeneratingPDF" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
        <div *ngIf="isGeneratingPDF" class="loading-spinner"></div>
        {{ isGeneratingPDF ? 'Generating...' : 'Generate PDF' }}
      </button>
    </div>
  </div>

  <div class="recent-tasks-section">
    <div class="section-header">
      <h2>Recent Tasks</h2>
      <div class="task-header-actions">
        <span class="task-count">{{ recentTasks.length }} of {{ totalTasks }} tasks</span>
        <div class="share-buttons">
          <button class="share-btn whatsapp" (click)="shareViaWhatsApp()" title="Share via WhatsApp" [disabled]="isSharing">
            <svg *ngIf="!isSharing" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
            <div *ngIf="isSharing" class="loading-spinner"></div>
            <span>{{ isSharing ? 'Preparing...' : 'Share via WhatsApp' }}</span>
          </button>
          <button class="share-btn email" (click)="shareViaEmail()" title="Share via Email" [disabled]="isSharing">
            <svg *ngIf="!isSharing" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
            </svg>
            <div *ngIf="isSharing" class="loading-spinner"></div>
            <span>{{ isSharing ? 'Preparing...' : 'Share via Email' }}</span>
          </button>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="recentTasks.length === 0">
      <div class="graduation-cap-icon-large">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 3L1 9L12 15L21 9V16H23V9L12 3Z" fill="#9ca3af"/>
          <path d="M5 13.18V17.18C5 17.97 5.63 18.74 6.4 19.09C8.61 20.15 10.26 20.73 12 20.73C13.74 20.73 15.39 20.15 17.6 19.09C18.37 18.74 19 17.97 19 17.18V13.18L12 17L5 13.18Z" fill="#9ca3af"/>
        </svg>
      </div>
      <h3>No tasks logged yet</h3>
      <p>Start by logging your first academic activity</p>
      <button class="log-task-btn" (click)="logFirstTask()">
        Log Your First Task
      </button>
    </div>
    
    <div class="task-list" *ngIf="recentTasks.length > 0">
      <div class="task-item" *ngFor="let task of recentTasks">
        <div class="task-header">
          <h3 class="task-subject">{{ task.subject }}</h3>
          <span class="task-type" [ngClass]="task.workType.toLowerCase()">{{ task.workType }}</span>
        </div>
        <div class="task-details">
          <div class="task-date">{{ task.date | date: 'mediumDate' }}</div>
          <div class="task-hours">{{ task.hours }}h</div>
        </div>
        <p class="task-description" *ngIf="task.description">{{ task.description }}</p>
      </div>
      
      <button class="view-all-btn" (click)="navigateToTab('log-task')">
        View All Tasks
      </button>
    </div>
  </div>
</div>